// append the new comment to the existing ones
<% if params[:action] == 'update' %>
	
	$('#<%= @comment.id %>').replaceWith('<%= j render("comments/comment", comment: @comment, subcomment: @comment.comment_id? ) %>');
	$('.edit_overlay').fadeOut(300, function(){
	  $('.edit_comment').fadeOut(200);
	});
	
<% elsif @comment.comment_id.nil? %>

	$('.comments').append('<%= j render("comments/comment", comment: @comment, subcomment: false ) %>') ;
	$('.comments #<%= @comment.id %>').hide().fadeIn('slow');

	$('.new_comments textarea').val('');

<% else %>

	$('#<%= @comment.comment_id %>').children('.subcomments').append('<%= j render("comments/comment", comment: @comment, subcomment: true ) %>') ;
	$('.subcomments #<%= @comment.id %>').hide().fadeIn('slow');

	$('.new_subcomments textarea').val('');

<% end %>

$('.new_subcomments').slideUp();
// scroll effect to set the right place

console.log('#<%= @comment.id %>');
console.log($('#<%= @comment.id %>').offset().top);
$("html, body").animate({scrollTop: findPos(document.getElementById("<%= @comment.id %>")) - 50 }, 1000);

function findPos(obj) {
	var curleft = curtop = 0;
	if (obj.offsetParent) {
		do {
			curleft += obj.offsetLeft;
			curtop += obj.offsetTop;
		} while (obj = obj.offsetParent);
		return curtop;
	}
}